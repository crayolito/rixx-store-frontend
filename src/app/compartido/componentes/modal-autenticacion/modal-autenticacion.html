<app-modal [estaAbierto]="estaAbierto()" (cerrar)="cerrarModal()">
  <div class="auth-contenedor">
    <!-- Botón cerrar -->
    <button class="auth-cerrar" (click)="cerrarModal()">
      <img src="/iconos/ico-cerrar.svg" alt="Cerrar">
    </button>

    <!-- Título dinámico según modo -->
    <h2 class="auth-titulo">
      @if (modoActual() === 'login') {
      Iniciar sesión
      } @else {
      Crear cuenta
      }
    </h2>

    <!-- Formulario LOGIN -->
    @if (modoActual() === 'login') {
    <form class="auth-formulario" (submit)="emitirIniciarSesion(); $event.preventDefault()">
      <!-- Email -->
      <div class="auth-campo-grupo">
        <label class="auth-label">Email</label>
        <input type="email" class="auth-campo" placeholder="tu@email.com" [value]="emailLogin()"
          (input)="emailLogin.set($any($event.target).value)">
      </div>

      <!-- Contraseña con ojito -->
      <div class="auth-campo-grupo">
        <label class="auth-label">Contraseña</label>
        <div class="auth-campo-contrasena">
          <input [type]="mostrarContrasena() ? 'text' : 'password'" class="auth-campo" placeholder="Tu contraseña"
            [value]="contrasenaLogin()" (input)="contrasenaLogin.set($any($event.target).value)">
          <button type="button" class="auth-campo-icono" (click)="alternarVisibilidadContrasena()">
            <img [src]="mostrarContrasena() ? '/iconos/ico-ojo-abierto.svg' : '/iconos/ico-ojo-cerrado.svg'"
              alt="Mostrar/Ocultar">
          </button>
        </div>
      </div>

      <!-- Link olvidar contraseña -->
      <a href="#" class="auth-link-secundario">¿Has olvidado tu contraseña?</a>

      <!-- Botón iniciar sesión -->
      <button type="submit" class="boton-primario auth-boton" [disabled]="enviando()">
        {{ enviando() ? 'Procesando...' : 'Iniciar sesión' }}
      </button>
      <!-- Link para cambiar a registro -->
      <p class="auth-texto-cambio">
        ¿Aún no posees cuenta?
        <a href="#" (click)="alternarModo(); $event.preventDefault()" class="auth-link-primario">
          Regístrate
        </a>
      </p>
    </form>
    }

    <!-- Formulario REGISTRO -->
    @else {
    <form class="auth-formulario" (submit)="emitirRegistro(); $event.preventDefault()">
      <!-- Nombre -->
      <div class="auth-campo-grupo">
        <label class="auth-label">Nombre</label>
        <input type="text" class="auth-campo" placeholder="Tu nombre" [value]="nombreRegistro()"
          (input)="nombreRegistro.set($any($event.target).value)">
      </div>

      <!-- Email -->
      <div class="auth-campo-grupo">
        <label class="auth-label">Email</label>
        <input type="email" class="auth-campo" placeholder="tu@email.com" [value]="emailRegistro()"
          (input)="emailRegistro.set($any($event.target).value)">
      </div>

      <!-- Teléfono / Región (prefijo = región; opcional) -->
      <div class="auth-campo-grupo">
        <label class="auth-label">Teléfono y región</label>
        <div class="auth-campo-telefono">
          <div class="auth-telefono-prefijo" (click)="alternarSelectorPais()">
            <img [src]="paisSeleccionado().bandera" alt="" class="auth-pais-bandera">
            <span class="auth-telefono-sigla">{{ paisSeleccionado().sigla }}</span>
            <img src="/iconos/ico-flecha-abajo-opciones.svg" alt="" class="auth-selector-flecha">

            @if (selectorPaisAbierto()) {
            <div class="auth-selector-opciones" (click)="$event.stopPropagation()">
              @for (pais of paises; track pais.codigo) {
              <div class="auth-selector-opcion" (click)="seleccionarPais(pais)">
                <img [src]="pais.bandera" alt="" class="auth-pais-bandera">
                <span class="auth-opcion-sigla">{{ pais.sigla }}</span>
              </div>
              }
            </div>
            }
          </div>
          <input type="tel" class="auth-campo auth-campo-telefono-input" inputmode="numeric"
            [placeholder]="paisSeleccionado().sigla + ' 1234567890'" [value]="telefonoRegistro()"
            (input)="onTelefonoInput($event)">
        </div>
      </div>

      <!-- Contraseña -->
      <div class="auth-campo-grupo">
        <label class="auth-label">Contraseña</label>
        <div class="auth-campo-contrasena">
          <input [type]="mostrarContrasena() ? 'text' : 'password'" class="auth-campo" placeholder="Mínimo 8 caracteres"
            [value]="contrasenaRegistro()" (input)="contrasenaRegistro.set($any($event.target).value)">
          <button type="button" class="auth-campo-icono" (click)="alternarVisibilidadContrasena()">
            <img [src]="mostrarContrasena() ? '/iconos/ico-ojo-abierto.svg' : '/iconos/ico-ojo-cerrado.svg'"
              alt="Mostrar/Ocultar">
          </button>
        </div>
      </div>

      <!-- Confirmar contraseña -->
      <div class="auth-campo-grupo">
        <label class="auth-label">Confirmar contraseña</label>
        <div class="auth-campo-contrasena">
          <input [type]="mostrarConfirmarContrasena() ? 'text' : 'password'" class="auth-campo"
            placeholder="Repite tu contraseña" [value]="confirmarContrasenaRegistro()"
            (input)="confirmarContrasenaRegistro.set($any($event.target).value)">
          <button type="button" class="auth-campo-icono" (click)="alternarVisibilidadConfirmarContrasena()">
            <img [src]="mostrarConfirmarContrasena() ? '/iconos/ico-ojo-abierto.svg' : '/iconos/ico-ojo-cerrado.svg'"
              alt="Mostrar/Ocultar">
          </button>
        </div>
      </div>

      <!-- Botón registrarse -->
      <button type="submit" class="boton-primario auth-boton" [disabled]="enviando()">
        {{ enviando() ? 'Procesando...' : 'Registrarse' }}
      </button>

      <!-- Link para cambiar a login -->
      <p class="auth-texto-cambio">
        ¿Ya tienes cuenta?
        <a href="#" (click)="alternarModo(); $event.preventDefault()" class="auth-link-primario">
          Iniciar sesión
        </a>
      </p>
    </form>
    }

    <!-- Separador -->
    <div class="auth-separador">
      <span>o continuar con</span>
    </div>

    <!-- Botones social login -->
    <div class="auth-social">
      <button type="button" class="auth-social-boton" (click)="iniciarSesionConGoogle()">
        <img src="/imagenes/logo-google.png" alt="Google">
      </button>
    </div>
  </div>
</app-modal>