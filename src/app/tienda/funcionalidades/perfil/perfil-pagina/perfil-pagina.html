<div class="perfil-contenedor">
  <!-- ─── BANNER SUPERIOR CON FOTO DE PERFIL ─── -->
  <div class="perfil-banner">
    <div class="perfil-banner__contenido">
      <div class="perfil-banner__foto-contenedor">
        <label for="input-foto-perfil" class="perfil-banner__foto-label">
          @if (fotoPerfil() && fotoPerfil() !== '/imagenes/usuarios/default.jpg') {
          <img [src]="fotoPerfil()" alt="Foto de perfil" class="perfil-banner__foto">
          } @else {
          <img src="/imagenes/foto-perfil1.png" alt="Foto por defecto" class="perfil-banner__foto">
          }
          <div class="perfil-banner__foto-overlay">
            <img src="/iconos/ico-editar.svg" alt="Editar" class="perfil-banner__foto-icono">
          </div>
        </label>
        <input type="file" id="input-foto-perfil" accept="image/*" (change)="manejarCambioFoto($event)"
          style="display: none;">
      </div>
      <div class="perfil-banner__info">
        <h1 class="perfil-banner__nombre">{{ nombre() }}</h1>
        <p class="perfil-banner__email">{{ email() }}</p>
      </div>
    </div>
  </div>

  <!-- ─── LAYOUT PRINCIPAL ─── -->
  <div class="perfil-layout">
    <!-- ─── MENÚ LATERAL ─── -->
    <aside class="perfil-menu">
      <nav class="perfil-menu__navegacion">
        <button class="perfil-menu__opcion" [class.perfil-menu__opcion--activa]="seccionActiva() === 'perfil'"
          (click)="cambiarSeccion('perfil')" type="button">
          <img src="/iconos/ico-cliente.svg" alt="Perfil" class="perfil-menu__icono">
          <span>Mi Perfil</span>
        </button>
        <button class="perfil-menu__opcion" [class.perfil-menu__opcion--activa]="seccionActiva() === 'pedidos'"
          (click)="cambiarSeccion('pedidos')" type="button">
          <img src="/iconos/ico-orden.svg" alt="Pedidos" class="perfil-menu__icono">
          <span>Mis Pedidos</span>
        </button>
        <button class="perfil-menu__opcion" [class.perfil-menu__opcion--activa]="seccionActiva() === 'billetera'"
          (click)="cambiarSeccion('billetera')" type="button">
          <img src="/iconos/ico-billetera.svg" alt="Billetera" class="perfil-menu__icono">
          <span>Billetera</span>
        </button>
      </nav>
    </aside>

    <!-- ─── CONTENIDO PRINCIPAL ─── -->
    <main class="perfil-contenido">
      <!-- ═══════════════════════════════════════════════════════
           SECCIÓN: MI PERFIL
           ═══════════════════════════════════════════════════════ -->
      @if (seccionActiva() === 'perfil') {
      <section class="perfil-seccion">
        <div class="perfil-seccion__header">
          <h2 class="perfil-seccion__titulo">Información Personal</h2>
          <p class="perfil-seccion__subtitulo">Administra tu información de cuenta</p>
        </div>

        <div class="perfil-datos">
          <!-- Datos básicos del usuario -->
          <div class="perfil-datos__grid">
            <div class="perfil-dato-card">
              <div class="perfil-dato-card__header">
                <img src="/iconos/ico-cliente.svg" alt="Nombre" class="perfil-dato-card__icono">
                <span class="perfil-dato-card__label">Nombre</span>
              </div>
              @if (!estaEditando()) {
              <p class="perfil-dato-card__valor">{{ nombre() }}</p>
              } @else {
              <div class="global-formulario-campo">
                <div class="global-formulario-campo__contenedor">
                  <input type="text" class="global-formulario-campo__input" placeholder="Tu nombre"
                    [value]="nombreTemporal()" (input)="actualizarNombre($event)">
                </div>
              </div>
              }
            </div>

            <div class="perfil-dato-card">
              <div class="perfil-dato-card__header">
                <img src="/iconos/ico-marketing.svg" alt="Email" class="perfil-dato-card__icono">
                <span class="perfil-dato-card__label">Correo electrónico</span>
              </div>
              @if (!estaEditando()) {
              <p class="perfil-dato-card__valor">{{ email() }}</p>
              } @else {
              <div class="global-formulario-campo">
                <div class="global-formulario-campo__contenedor">
                  <input type="email" class="global-formulario-campo__input" placeholder="Ej: usuario@ejemplo.com"
                    [value]="emailTemporal()" (input)="actualizarEmail($event)">
                </div>
              </div>
              }
            </div>

            <div class="perfil-dato-card">
              <div class="perfil-dato-card__header">
                <img src="/iconos/ico-configuracion.svg" alt="Teléfono" class="perfil-dato-card__icono">
                <span class="perfil-dato-card__label">Teléfono</span>
              </div>
              @if (!estaEditando()) {
              <p class="perfil-dato-card__valor">{{ telefono() || '—' }}</p>
              } @else {
              <div class="perfil-datos__telefono-edicion">
                <div class="perfil-datos__telefono-prefijo" (click)="alternarSelectorPais()">
                  <img [src]="paisSeleccionado().bandera" alt="" class="auth-pais-bandera">
                  <span>{{ paisSeleccionado().sigla }}</span>
                </div>
                <input type="tel" class="global-formulario-campo__input"
                  [placeholder]="paisSeleccionado().sigla + ' 123 456 7890'" [value]="telefonoTemporal()"
                  (input)="actualizarTelefono($event)">
              </div>
              @if (selectorPaisAbierto()) {
              <div class="perfil-datos__selector-pais" (click)="$event.stopPropagation()">
                @for (pais of paises; track pais.codigo) {
                <div class="perfil-datos__opcion-pais" (click)="seleccionarPais(pais)">
                  <img [src]="pais.bandera" alt="" class="auth-pais-bandera">
                  <span>{{ pais.sigla }}</span>
                </div>
                }
              </div>
              }
              }
            </div>

            <div class="perfil-dato-card">
              <div class="perfil-dato-card__header">
                <img src="/iconos/ico-configuracion.svg" alt="Nacionalidad" class="perfil-dato-card__icono">
                <span class="perfil-dato-card__label">Nacionalidad</span>
              </div>
              @if (!estaEditando()) {
              <p class="perfil-dato-card__valor">{{ nacionalidad() || paisNacionalidad().nombre || '—' }}</p>
              } @else {
              <div class="perfil-datos__telefono-prefijo" (click)="alternarSelectorNacionalidad()">
                <img [src]="paisNacionalidad().bandera" alt="" class="auth-pais-bandera">
                <span>{{ paisNacionalidad().nombre }}</span>
              </div>
              @if (selectorNacionalidadAbierto()) {
              <div class="perfil-datos__selector-pais" (click)="$event.stopPropagation()">
                @for (pais of paises; track pais.codigo) {
                <div class="perfil-datos__opcion-pais" (click)="seleccionarNacionalidadPerfil(pais)">
                  <img [src]="pais.bandera" alt="" class="auth-pais-bandera">
                  <span>{{ pais.nombre }}</span>
                </div>
                }
              </div>
              }
              }
            </div>
          </div>

          <!-- Botón Editar/Guardar -->
          <div class="perfil-datos__acciones">
            @if (!estaEditando()) {
            <button class="boton-primario perfil-billetera__boton" (click)="activarEdicion()" type="button"
              [disabled]="guardando()">
              <p>Editar Información</p>
            </button>
            } @else {
            <div class="perfil-datos__botones-edicion">
              <button class="boton-secundario perfil-billetera__boton" (click)="cancelarEdicion()" type="button">
                <p>Cancelar</p>
              </button>
              <button class="boton-primario perfil-billetera__boton" (click)="guardarCambios()" type="button"
                [disabled]="guardando()">
                <p>{{ guardando() ? 'Procesando...' : 'Guardar Cambios' }}</p>
              </button>
            </div>
            }
          </div>

          <!-- Sección de contraseña: solo si NO es social login -->
          <div class="perfil-contrasena-seccion">
            @if (tieneSocialLogin()) {
            <div class="perfil-contrasena-seccion__header">
              <div class="perfil-contrasena-seccion__info">
                <img src="/iconos/ico-configuracion.svg" alt="Contraseña" class="perfil-contrasena-seccion__icono">
                <span class="perfil-contrasena-seccion__titulo">Seguridad de la cuenta</span>
              </div>
            </div>
            <div class="perfil-mensaje-google">
              <img src="/imagenes/logo-google.png" alt="Google" class="perfil-mensaje-google__logo">
              <div class="perfil-mensaje-google__contenido">
                <h4 class="perfil-mensaje-google__titulo">Cambio de contraseña no disponible</h4>
                <p class="perfil-mensaje-google__texto">
                  Esta cuenta está vinculada con Google, por lo que no es posible cambiar la contraseña. Si deseas
                  cambiar tu contraseña, puedes hacerlo directamente desde tu cuenta de Google.
                </p>
              </div>
            </div>
            } @else {
            <div class="perfil-contrasena-seccion__header">
              <div class="perfil-contrasena-seccion__info">
                <img src="/iconos/ico-configuracion.svg" alt="Contraseña" class="perfil-contrasena-seccion__icono">
                <span class="perfil-contrasena-seccion__titulo">Seguridad de la cuenta</span>
              </div>
              <label class="perfil-toggle">
                <input type="checkbox" class="perfil-toggle__input" [checked]="mostrarCambioContrasena()"
                  (change)="toggleCambioContrasena()">
                <span class="perfil-toggle__slider"></span>
              </label>
            </div>
            @if (mostrarCambioContrasena()) {
            <div class="perfil-contrasena-contenido">
              <div class="perfil-formulario-contrasena">
                <div class="perfil-datos__grid">
                  <div class="perfil-dato-card">
                    <div class="perfil-dato-card__header">
                      <img src="/iconos/ico-configuracion.svg" alt="Nueva contraseña" class="perfil-dato-card__icono">
                      <span class="perfil-dato-card__label">Nueva contraseña</span>
                    </div>
                    <div class="global-formulario-campo">
                      <div class="global-formulario-campo__contenedor">
                        <input [type]="mostrarContrasena() ? 'text' : 'password'" class="global-formulario-campo__input"
                          placeholder="••••••••" [value]="nuevaContrasena()"
                          (input)="actualizarNuevaContrasena($event)">
                        <button type="button" class="global-formulario-campo__boton-icono"
                          (click)="toggleMostrarContrasena()">
                          <img
                            [src]="mostrarContrasena() ? '/iconos/ico-ojo-cerrado.svg' : '/iconos/ico-ojo-abierto.svg'"
                            [alt]="mostrarContrasena() ? 'Ocultar' : 'Mostrar'" class="icono-boton icono-color-blanco">
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                <button class="boton-primario perfil-billetera__boton" (click)="guardarPerfil()" type="button"
                  [disabled]="guardando()">
                  <p>{{ guardando() ? 'Procesando...' : 'Cambiar Contraseña' }}</p>
                </button>
              </div>
            </div>
            }
            }
          </div>
        </div>
      </section>
      }

      <!-- ═══════════════════════════════════════════════════════
           SECCIÓN: MIS PEDIDOS (Automáticos + Gift Cards)
           ═══════════════════════════════════════════════════════ -->
      @if (seccionActiva() === 'pedidos') {
      <section class="perfil-seccion perfil-seccion--pedidos">
        <div class="perfil-seccion__header">
          <h2 class="perfil-seccion__titulo">Mis Pedidos</h2>
          <p class="perfil-seccion__subtitulo">Revisa tus compras y códigos Gift Card</p>
        </div>

        <!-- Switch: ver ambos tipos a la vez o uno -->
        <div class="perfil-pedidos-switch">
          <button type="button" class="perfil-pedidos-switch__btn"
            [class.perfil-pedidos-switch__btn--activo]="tipoPedidoVista() === 'automaticos'"
            (click)="tipoPedidoVista.set('automaticos')">Automáticos</button>
          <button type="button" class="perfil-pedidos-switch__btn"
            [class.perfil-pedidos-switch__btn--activo]="tipoPedidoVista() === 'gift_cards'"
            (click)="tipoPedidoVista.set('gift_cards')">Gift Cards</button>
        </div>

        <!-- Filtros comunes -->
        <div class="perfil-pedidos-filtros">
          <div class="perfil-pedidos-filtros__grupo perfil-pedidos-filtros__grupo--nombre">
            <label class="perfil-pedidos-filtros__label">Nombre producto</label>
            <input type="text" class="perfil-pedidos-filtros__input" placeholder="Buscar por nombre"
              [value]="filtroNombreProducto()" (input)="filtroNombreProducto.set($any($event.target).value)">
          </div>
          <div class="perfil-pedidos-filtros__grupo">
            <label class="perfil-pedidos-filtros__label">Desde</label>
            <input type="date" class="perfil-pedidos-filtros__input" [value]="filtroFechaDesde()"
              (input)="filtroFechaDesde.set($any($event.target).value)">
          </div>
          <div class="perfil-pedidos-filtros__grupo">
            <label class="perfil-pedidos-filtros__label">Hasta</label>
            <input type="date" class="perfil-pedidos-filtros__input" [value]="filtroFechaHasta()"
              (input)="filtroFechaHasta.set($any($event.target).value)">
          </div>
        </div>

        <!-- Apartado 1: Pedidos automáticos (visible si Todos o Automáticos) -->
        @if (tipoPedidoVista() === 'todos' || tipoPedidoVista() === 'automaticos') {
        <div class="perfil-pedidos-apartado">
          <h3 class="perfil-pedidos-apartado__titulo">Pedidos automáticos / Compra directa</h3>
          <div class="perfil-pedidos">
            @for (pedido of pedidosAutomaticosFiltrados(); track pedido.id) {
            <div class="perfil-pedido-card">
              <div class="perfil-pedido-card__header">
                <div class="perfil-pedido-card__header-info">
                  <p class="perfil-pedido-card__fecha">{{ pedido.fecha_compra | date:'d MMM yyyy, h:mm a' }}</p>
                </div>
                <button class="boton-primario perfil-billetera__boton" (click)="reordenar(pedido)"
                  type="button">Reordenar</button>
                <span class="perfil-pedido-card__badge perfil-pedido-card__badge--{{pedido.estado}}">{{ pedido.estado
                  }}</span>
              </div>
              <div class="perfil-pedido-card__productos">
                @for (prod of pedido.productos; track prod.id; let index = $index) {
                @if (index < limiteProductosVisibles || mostrarTodosProductos(pedido.id)) { <div
                  class="perfil-pedido-card__producto">
                  <img [src]="prod.imagen || '/imagenes/producto-default.png'" [alt]="prod.nombre"
                    class="perfil-pedido-card__producto-imagen">
                  <div class="perfil-pedido-card__producto-info">
                    <p class="perfil-pedido-card__producto-nombre">{{ prod.nombre }}</p>
                    <p class="perfil-pedido-card__producto-cantidad">Cantidad: {{ prod.cantidad }}</p>
                  </div>
              </div>
              }
              }
              @if (pedido.productos.length > limiteProductosVisibles && !mostrarTodosProductos(pedido.id)) {
              <button class="perfil-pedido-card__producto-mas" (click)="mostrarMasProductos(pedido.id)" type="button">
                <span>+{{ pedido.productos.length - limiteProductosVisibles }} más</span>
              </button>
              }
            </div>
            @if (pedido.datosEntrega && (pedido.datosEntrega.idJugador || pedido.datosEntrega.idServer) &&
            mostrarTodosProductos(pedido.id)) {
            <div class="perfil-pedido-card__detalle">
              @if (pedido.datosEntrega.idJugador) {
              <p class="perfil-pedido-card__detalle-item"><strong>ID Jugador:</strong> {{ pedido.datosEntrega.idJugador
                }}</p>
              }
              @if (pedido.datosEntrega.idServer) {
              <p class="perfil-pedido-card__detalle-item"><strong>ID Servidor:</strong> {{ pedido.datosEntrega.idServer
                }}</p>
              }
            </div>
            }
            <div class="perfil-pedido-card__footer">
              <div class="perfil-pedido-card__resumen">
                <div class="perfil-pedido-card__resumen-item">
                  <span class="perfil-pedido-card__resumen-label">Productos:</span>
                  <span class="perfil-pedido-card__resumen-valor">{{ pedido.productos.length }}</span>
                </div>
                <div class="perfil-pedido-card__resumen-item perfil-pedido-card__resumen-item--total">
                  <span class="perfil-pedido-card__resumen-label">Total:</span>
                  <span class="perfil-pedido-card__total-monto">${{ pedido.total_compra }} USD</span>
                </div>
              </div>
            </div>
          </div>
          } @empty {
          <div class="perfil-pedidos-vacio">
            <img src="/iconos/ico-orden.svg" alt="Sin pedidos" class="perfil-pedidos-vacio__icono">
            <p class="perfil-pedidos-vacio__texto">No tienes pedidos automáticos</p>
          </div>
          }
        </div>
  </div>
  }

  <!-- Apartado 2: Pedidos Gift Card (visible si Todos o Gift Cards) -->
  @if (tipoPedidoVista() === 'todos' || tipoPedidoVista() === 'gift_cards') {
  <div class="perfil-pedidos-apartado">
    <h3 class="perfil-pedidos-apartado__titulo">Pedidos Gift Card (códigos manuales)</h3>
    @if (!identidadVerificada()) {
    <div class="perfil-pedidos-gift-bloque">
      <p class="perfil-pedidos-gift-aviso">Para ver tus códigos PIN debes verificar tu identidad.</p>
      <button class="perfil-pedidos-gift-boton" (click)="verCodigosGiftCard()" type="button">
        <img src="/iconos/ico-codigo.svg" alt="" class="perfil-pedidos-gift-boton__icono"> Ver códigos Gift Card
      </button>
    </div>
    }
    @if (identidadVerificada()) {
    <div class="perfil-pedidos">
      @for (pedido of pedidosGiftCardFiltrados(); track pedido.id) {
      <div class="perfil-gift-card">
        <div class="perfil-gift-card__header">
          <h4 class="perfil-gift-card__nombre">{{ pedido.nombre }}</h4>
          <p class="perfil-gift-card__fecha">Fecha de emisión: {{ pedido.fechaEmision | date:'d MMM yyyy, h:mm a' }}</p>
        </div>
        <div class="perfil-gift-card__codigos">
          @for (codigo of pedido.codigos; track $index) {
          <div class="perfil-gift-card__codigo-fila">
            <span class="perfil-gift-card__codigo-serial">Serial: {{ codigo.serial ?? 'N/A' }}</span>
            <span class="perfil-gift-card__codigo-pin">PIN: {{ codigo.pin ?? 'N/A' }}</span>
            <button type="button" class="perfil-gift-card__copiar"
              (click)="copiarCodigoIndividual((codigo.serial ?? '') + ' ' + (codigo.pin ?? ''))" title="Copiar">
              <img src="/iconos/ico-copiar.svg" alt="Copiar" class="perfil-gift-card__copiar-icono">
            </button>
          </div>
          }
        </div>
        <div class="perfil-gift-card__valor">Valor total: ${{ pedido.valorTotal }} USD</div>
        <div class="perfil-gift-card__instrucciones-bloque">
          <span class="perfil-gift-card__instrucciones-label">Instrucciones</span>
          <p class="perfil-gift-card__instrucciones">{{ pedido.instrucciones || 'Sin instrucciones específicas.' }}</p>
        </div>
        <button type="button" class="perfil-gift-card__copiar-todo" (click)="copiarTodoGiftCard(pedido)"
          title="Copia todos los códigos, valor e instrucciones">
          <img src="/iconos/ico-copiar.svg" alt="Copiar todo" class="perfil-gift-card__copiar-icono"> Copiar todo
        </button>
      </div>
      } @empty {
      <div class="perfil-pedidos-vacio">
        <p class="perfil-pedidos-vacio__texto">No tienes pedidos con Gift Card</p>
      </div>
      }
    </div>
    }
  </div>
  }
  </section>
  }

  <!-- Modal Verificar Identidad (Gift Cards) - UI/UX mejorado -->
  <app-modal [estaAbierto]="modalVerificarIdentidadAbierto()" (cerrar)="cerrarModalVerificarIdentidad()">
    <div class="perfil-modal-verificar">
      <div class="perfil-modal-verificar__icono">
        <img src="/iconos/ico-configuracion.svg" alt="" aria-hidden="true">
      </div>
      <h3 class="perfil-modal-verificar__titulo">Verificar Identidad</h3>
      <p class="perfil-modal-verificar__descripcion">Para acceder a tus códigos PIN de forma segura, ingresa la
        contraseña de tu cuenta.</p>
      <label class="perfil-modal-verificar__label">Contraseña</label>
      <div class="global-formulario-campo">
        <div class="global-formulario-campo__contenedor">
          <input type="password" class="global-formulario-campo__input" placeholder="Ingresa tu contraseña"
            [value]="contrasenaVerificacion()" (input)="actualizarContrasenaVerificacion($event)">
        </div>
      </div>
      <div class="perfil-modal-verificar__acciones">
        <button type="button" class="perfil-modal-verificar__cancelar"
          (click)="cerrarModalVerificarIdentidad()">Cancelar</button>
        <button type="button" class="perfil-modal-verificar__verificar"
          (click)="verificarIdentidad()">Verificar</button>
      </div>
    </div>
  </app-modal>

  <!-- ═══════════════════════════════════════════════════════
           SECCIÓN: BILLETERA
           ═══════════════════════════════════════════════════════ -->
  @if (seccionActiva() === 'billetera') {
  <section class="perfil-seccion perfil-seccion--billetera">
    <div class="perfil-seccion__header">
      <h2 class="perfil-seccion__titulo">Mi Billetera</h2>
      <p class="perfil-seccion__subtitulo">Saldo, recargas e historial de movimientos</p>
    </div>

    <!-- Tarjeta de Saldo -->
    <div class="perfil-billetera-saldo">
      <div class="perfil-billetera-saldo__contenido">
        <div class="perfil-billetera-saldo__icono">
          <img src="/iconos/ico-billetera.svg" alt="" aria-hidden="true">
        </div>
        <p class="perfil-billetera-saldo__etiqueta">Saldo disponible</p>
        <p class="perfil-billetera-saldo__monto">${{ saldoActual() }}</p>
        <p class="perfil-billetera-saldo__moneda">USD</p>
      </div>
      <div class="perfil-billetera-saldo__decoracion"></div>
    </div>

    <!-- Paquetes de recarga -->
    <div class="perfil-billetera-paquetes">
      <label class="perfil-billetera-paquetes__etiqueta">Selecciona un monto</label>
      <div class="perfil-billetera-paquetes__grid">
        @for (paquete of paquetes; track paquete.id) {
        <button class="perfil-billetera-paquete"
          [class.perfil-billetera-paquete--activo]="paqueteSeleccionado()?.id === paquete.id"
          (click)="seleccionarPaquete(paquete)" type="button">
          <span class="perfil-billetera-paquete__monto">${{ paquete.monto }}</span>
          <span class="perfil-billetera-paquete__moneda">USD</span>
        </button>
        }
      </div>

      <!-- Cantidad personalizada -->
      <div class="perfil-billetera-custom">
        <label class="perfil-billetera-custom__etiqueta">O ingresa un monto personalizado</label>
        <div class="perfil-billetera-custom__input-contenedor">
          <span class="perfil-billetera-custom__simbolo">$</span>
          <input type="number" class="perfil-billetera-custom__input" placeholder="0.00" min="0" step="0.01"
            [value]="cantidadEspecial()" (input)="actualizarCantidadEspecial($event)"
            (focus)="seleccionarPaquete(null)">
          <span class="perfil-billetera-custom__moneda">USD</span>
        </div>
      </div>
    </div>

    <!-- Métodos de pago -->
    <div class="perfil-billetera-metodos">
      <label class="perfil-billetera-metodos__etiqueta">Método de pago</label>
      <div class="perfil-billetera-metodos__lista">
        @for (metodo of metodosPago; track metodo.id) {
        <label class="perfil-billetera-metodo-card">
          <div class="perfil-billetera-metodo-card__contenido">
            <input type="radio" class="perfil-billetera-metodo-card__radio" name="metodo-pago" [value]="metodo.id"
              [checked]="metodoPagoSeleccionado() === metodo.id" (change)="seleccionarMetodoPago(metodo.id)">
            <img [src]="metodo.logo" [alt]="metodo.nombre" class="perfil-billetera-metodo-card__logo">
            <div class="perfil-billetera-metodo-card__info">
              <p class="perfil-billetera-metodo-card__nombre">{{ metodo.nombre }}</p>
              <p class="perfil-billetera-metodo-card__descripcion">{{ metodo.descripcion }}</p>
            </div>
          </div>
        </label>
        }
      </div>
    </div>

    <!-- Botón recargar -->
    <button class="perfil-billetera-recargar" (click)="recargarBilletera()" [disabled]="!puedeRecargar()" type="button">
      Recargar
    </button>

    <!-- Historial de transacciones -->
    <div class="perfil-billetera-historial">
      <h3 class="perfil-billetera-historial__titulo">
        <img src="/iconos/ico-opcion-cronologia.svg" alt="" class="perfil-billetera-historial__icono"> Historial de
        transacciones
      </h3>
      <div class="perfil-billetera-historial__lista">
        @for (tx of transaccionesBilletera(); track tx.id) {
        <div class="perfil-billetera-transaccion">
          <div class="perfil-billetera-transaccion__info">
            <span class="perfil-billetera-transaccion__fecha">{{ tx.fecha | date:'d MMM yyyy, H:mm' }}</span>
            <span class="perfil-billetera-transaccion__tipo perfil-billetera-transaccion__tipo--{{ tx.tipo }}">{{
              tx.tipo }}</span>
            <span class="perfil-billetera-transaccion__descripcion">{{ tx.descripcion }}</span>
          </div>
          <div class="perfil-billetera-transaccion__monto"
            [class.perfil-billetera-transaccion__monto--negativo]="tx.monto < 0">
            {{ tx.monto >= 0 ? '+' : '' }}${{ tx.monto }} USD
          </div>
          @if (tx.saldoResultante != null) {
          <span class="perfil-billetera-transaccion__saldo">Saldo: ${{ tx.saldoResultante }} USD</span>
          }
        </div>
        } @empty {
        <p class="perfil-billetera-historial__vacio">No hay transacciones aún</p>
        }
      </div>
    </div>
  </section>
  }
  </main>
</div>
</div>